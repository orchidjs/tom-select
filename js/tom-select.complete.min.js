/*! tom-select.js - v1.0.0-beta | https://github.com/orchidjs/tom-select | Apache License (v2) */

!function(t,e){"function"==typeof define&&define.amd?define("sifter",e):"object"==typeof exports?module.exports=e():t.Sifter=e()}(this,function(){function t(t,e){this.items=t,this.settings=e||{diacritics:!0}}t.prototype.tokenize=function(t){if(!(t=a(String(t||"").toLowerCase()))||!t.length)return[];for(var e,i,n=[],o=t.split(/ +/),s=0,r=o.length;s<r;s++){if(e=l(o[s]),this.settings.diacritics)for(i in u)u.hasOwnProperty(i)&&(e=e.replace(new RegExp(i,"g"),u[i]));n.push({string:o[s],regex:new RegExp(e,"i")})}return n},t.prototype.iterator=function(t,e){var i=r(t)?Array.prototype.forEach||function(t){for(var e=0,i=this.length;e<i;e++)t(this[e],e,this)}:function(t){for(var e in this)this.hasOwnProperty(e)&&t(this[e],e,this)};i.apply(t,[e])},t.prototype.getScoreFunction=function(t,e){var o,s,r,a;t=this.prepareSearch(t,e),s=t.tokens,o=t.options.fields,r=s.length,a=t.options.nesting;function l(t,e){var i,n;return!t||-1===(n=(t=String(t||"")).search(e.regex))?0:(i=e.string.length/t.length,0===n&&(i+=.5),i)}var u,c=(u=o.length)?1===u?function(t,e){return l(f(e,o[0],a),t)}:function(t,e){for(var i=0,n=0;i<u;i++)n+=l(f(e,o[i],a),t);return n/u}:function(){return 0};return r?1===r?function(t){return c(s[0],t)}:"and"===t.options.conjunction?function(t){for(var e,i=0,n=0;i<r;i++){if((e=c(s[i],t))<=0)return 0;n+=e}return n/r}:function(t){for(var e=0,i=0;e<r;e++)i+=c(s[e],t);return i/r}:function(){return 0}},t.prototype.getSortFunction=function(t,i){var e,n,o,s,r,a,l,u=this,c=!(t=u.prepareSearch(t,i)).query&&i.sort_empty||i.sort,p=function(t,e){return"$score"===t?e.score:f(u.items[e.id],t,i.nesting)},d=[];if(c)for(e=0,n=c.length;e<n;e++)!t.query&&"$score"===c[e].field||d.push(c[e]);if(t.query){for(l=!0,e=0,n=d.length;e<n;e++)if("$score"===d[e].field){l=!1;break}l&&d.unshift({field:"$score",direction:"desc"})}else for(e=0,n=d.length;e<n;e++)if("$score"===d[e].field){d.splice(e,1);break}for(a=[],e=0,n=d.length;e<n;e++)a.push("desc"===d[e].direction?-1:1);return(s=d.length)?1===s?(o=d[0].field,r=a[0],function(t,e){return r*h(p(o,t),p(o,e))}):function(t,e){for(var i,n,o=0;o<s;o++)if(n=d[o].field,i=a[o]*h(p(n,t),p(n,e)))return i;return 0}:null},t.prototype.prepareSearch=function(t,e){if("object"==typeof t)return t;var i=(e=s({},e)).fields,n=e.sort,o=e.sort_empty;return i&&!r(i)&&(e.fields=[i]),n&&!r(n)&&(e.sort=[n]),o&&!r(o)&&(e.sort_empty=[o]),{options:e,query:String(t||"").toLowerCase(),tokens:this.tokenize(t),total:0,items:[]}},t.prototype.search=function(t,i){var n,e,o,s=this,r=this.prepareSearch(t,i);return i=r.options,t=r.query,o=i.score||s.getScoreFunction(r),t.length?s.iterator(s.items,function(t,e){n=o(t),(!1===i.filter||0<n)&&r.items.push({score:n,id:e})}):s.iterator(s.items,function(t,e){r.items.push({score:1,id:e})}),(e=s.getSortFunction(r,i))&&r.items.sort(e),r.total=r.items.length,"number"==typeof i.limit&&(r.items=r.items.slice(0,i.limit)),r};var h=function(t,e){return"number"==typeof t&&"number"==typeof e?e<t?1:t<e?-1:0:(t=i(String(t||"")),(e=i(String(e||"")))<t?1:t<e?-1:0)},s=function(t,e){for(var i,n,o=1,s=arguments.length;o<s;o++)if(n=arguments[o])for(i in n)n.hasOwnProperty(i)&&(t[i]=n[i]);return t},f=function(t,e,i){if(t&&e){if(!i)return t[e];for(var n=e.split(".");n.length&&(t=t[n.shift()]););return t}},a=function(t){return(t+"").replace(/^\s+|\s+$|/g,"")},l=function(t){return(t+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},r=Array.isArray||"undefined"!=typeof $&&$.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},u={a:"[aá¸€á¸Ä‚ÄƒÃ‚Ã¢ÇÇŽÈºâ±¥È¦È§áº áº¡Ã„Ã¤Ã€Ã ÃÃ¡Ä€ÄÃƒÃ£Ã…Ã¥Ä…Ä„ÃƒÄ…Ä„]",b:"[bâ¢Î²Î’Bà¸¿ðŒá›’]",c:"[cÄ†Ä‡ÄˆÄ‰ÄŒÄÄŠÄ‹CÌ„cÌ„Ã‡Ã§á¸ˆá¸‰È»È¼Æ‡ÆˆÉ•á´„ï¼£ï½ƒ]",d:"[dÄŽÄá¸Šá¸‹á¸á¸‘á¸Œá¸á¸’á¸“á¸Žá¸ÄÄ‘DÌ¦dÌ¦Æ‰É–ÆŠÉ—Æ‹ÆŒáµ­á¶á¶‘È¡á´…ï¼¤ï½„Ã°]",e:"[eÃ‰Ã©ÃˆÃ¨ÃŠÃªá¸˜á¸™ÄšÄ›Ä”Ä•áº¼áº½á¸šá¸›áººáº»Ä–Ä—Ã‹Ã«Ä’Ä“È¨È©Ä˜Ä™á¶’É†É‡È„È…áº¾áº¿á»€á»á»„á»…á»‚á»ƒá¸œá¸á¸–á¸—á¸”á¸•È†È‡áº¸áº¹á»†á»‡â±¸á´‡ï¼¥ï½…É˜ÇÆÆÎµ]",f:"[fÆ‘Æ’á¸žá¸Ÿ]",g:"[gÉ¢â‚²Ç¤Ç¥ÄœÄÄžÄŸÄ¢Ä£Æ“É Ä Ä¡]",h:"[hÄ¤Ä¥Ä¦Ä§á¸¨á¸©áº–áº–á¸¤á¸¥á¸¢á¸£É¦Ê°Ç¶Æ•]",i:"[iÃÃ­ÃŒÃ¬Ä¬Ä­ÃŽÃ®ÇÇÃÃ¯á¸®á¸¯Ä¨Ä©Ä®Ä¯ÄªÄ«á»ˆá»‰ÈˆÈ‰ÈŠÈ‹á»Šá»‹á¸¬á¸­Æ—É¨É¨Ì†áµ»á¶–Ä°iIÄ±Éªï¼©ï½‰]",j:"[jÈ·Ä´ÄµÉˆÉ‰ÊÉŸÊ²]",k:"[kÆ˜Æ™ê€êá¸°á¸±Ç¨Ç©á¸²á¸³á¸´á¸µÎºÏ°â‚­]",l:"[lÅÅ‚Ä½Ä¾Ä»Ä¼Ä¹Äºá¸¶á¸·á¸¸á¸¹á¸¼á¸½á¸ºá¸»Ä¿Å€È½Æšâ± â±¡â±¢É«É¬á¶…É­È´ÊŸï¼¬ï½Œ]",n:"[nÅƒÅ„Ç¸Ç¹Å‡ÅˆÃ‘Ã±á¹„á¹…Å…Å†á¹†á¹‡á¹Šá¹‹á¹ˆá¹‰NÌˆnÌˆÆÉ²È Æžáµ°á¶‡É³ÈµÉ´ï¼®ï½ŽÅŠÅ‹]",o:"[oÃ˜Ã¸Ã–Ã¶Ã“Ã³Ã’Ã²Ã”Ã´Ç‘Ç’ÅÅ‘ÅŽÅÈ®È¯á»Œá»ÆŸÉµÆ Æ¡á»Žá»ÅŒÅÃ•ÃµÇªÇ«ÈŒÈÕ•Ö…]",p:"[pá¹”á¹•á¹–á¹—â±£áµ½Æ¤Æ¥áµ±]",q:"[qê–ê—Ê ÉŠÉ‹ê˜ê™qÌƒ]",r:"[rÅ”Å•ÉŒÉÅ˜Å™Å–Å—á¹˜á¹™ÈÈ‘È’È“á¹šá¹›â±¤É½]",s:"[sÅšÅ›á¹ á¹¡á¹¢á¹£êž¨êž©ÅœÅÅ Å¡ÅžÅŸÈ˜È™SÌˆsÌˆ]",t:"[tÅ¤Å¥á¹ªá¹«Å¢Å£á¹¬á¹­Æ®ÊˆÈšÈ›á¹°á¹±á¹®á¹¯Æ¬Æ­]",u:"[uÅ¬Å­É„Ê‰á»¤á»¥ÃœÃ¼ÃšÃºÃ™Ã¹Ã›Ã»Ç“Ç”Å°Å±Å¬Å­Æ¯Æ°á»¦á»§ÅªÅ«Å¨Å©Å²Å³È”È•âˆª]",v:"[vá¹¼á¹½á¹¾á¹¿Æ²Ê‹êžêŸâ±±Ê‹]",w:"[wáº‚áºƒáº€áºÅ´Åµáº„áº…áº†áº‡áºˆáº‰]",x:"[xáºŒáºáºŠáº‹Ï‡]",y:"[yÃÃ½á»²á»³Å¶Å·Å¸Ã¿á»¸á»¹áºŽáºá»´á»µÉŽÉÆ³Æ´]",z:"[zÅ¹Åºáºáº‘Å½Å¾Å»Å¼áº’áº“áº”áº•ÆµÆ¶]"},i=function(){var t,e,i,n,o="",s={};for(i in u)if(u.hasOwnProperty(i))for(o+=n=u[i].substring(2,u[i].length-1),t=0,e=n.length;t<e;t++)s[n.charAt(t)]=i;var r=new RegExp("["+o+"]","g");return function(t){return t.replace(r,function(t){return s[t]}).toLowerCase()}}();return t}),function(t,e){"function"==typeof define&&define.amd?define("microplugin",e):"object"==typeof exports?module.exports=e():t.MicroPlugin=e()}(this,function(){var t={mixin:function(n){n.plugins={},n.prototype.initializePlugins=function(t){var e,i,n,o=[];if(this.plugins={names:[],settings:{},requested:{},loaded:{}},s.isArray(t))for(e=0,i=t.length;e<i;e++)"string"==typeof t[e]?o.push(t[e]):(this.plugins.settings[t[e].name]=t[e].options,o.push(t[e].name));else if(t)for(n in t)t.hasOwnProperty(n)&&(this.plugins.settings[n]=t[n],o.push(n));for(;o.length;)this.require(o.shift())},n.prototype.loadPlugin=function(t){var e=this.plugins,i=n.plugins[t];if(!n.plugins.hasOwnProperty(t))throw new Error('Unable to find "'+t+'" plugin');e.requested[t]=!0,e.loaded[t]=i.fn.apply(this,[this.plugins.settings[t]||{}]),e.names.push(t)},n.prototype.require=function(t){var e=this.plugins;if(!this.plugins.loaded.hasOwnProperty(t)){if(e.requested[t])throw new Error('Plugin has circular dependency ("'+t+'")');this.loadPlugin(t)}return e.loaded[t]},n.define=function(t,e){n.plugins[t]={name:t,fn:e}}}},s={isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}};return t}),function(t,e){"function"==typeof define&&define.amd?define("tomselect",["sifter","microplugin"],e):"object"==typeof exports?module.exports=e(require("sifter"),require("microplugin")):t.TomSelect=e(t.Sifter,t.MicroPlugin)}(this,function(r,t){"use strict";function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t){return function(t){if(Array.isArray(t))return n(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return n(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return n(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function s(){}s.prototype={on:function(t,e){this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e)},off:function(t,e){var i=arguments.length;return 0===i?delete this._events:1===i?delete this._events[t]:(this._events=this._events||{},void(t in this._events!=!1&&this._events[t].splice(this._events[t].indexOf(e),1)))},trigger:function(t){if(this._events=this._events||{},t in this._events!=!1)for(var e=0;e<this._events[t].length;e++)this._events[t][e].apply(this,Array.prototype.slice.call(arguments,1))}},s.mixin=function(t){for(var e=["on","off","trigger"],i=0;i<e.length;i++)t.prototype[e[i]]=s.prototype[e[i]]};function a(u,t){var e,c=Object.assign({},D.defaults,t),p=c.dataAttr,d=c.labelField,h=c.valueField,f=c.disabledField,g=c.optgroupField,v=c.optgroupLabelField,m=c.optgroupValueField,i=u.tagName.toLowerCase(),n=u.getAttribute("placeholder")||u.getAttribute("data-placeholder");n||c.allowEmptyOption||(e=u.querySelector('option[value=""]'))&&(n=e.textContent);var y={placeholder:n,options:[],optgroups:[],items:[]};return("select"===i?function(){function r(t){var e=Object.assign({},t.dataset),i=p&&e[p];return"string"==typeof i&&i.length&&(e=Object.assign(e,JSON.parse(i))),e}function a(t,e){var i,n,o=k(t.value);(o||c.allowEmptyOption)&&(l.hasOwnProperty(o)?e&&((i=l[o][g])?Array.isArray(i)?i.push(e):l[o][g]=[i,e]:l[o][g]=e):((n=r(t))[d]=n[d]||t.textContent,n[h]=n[h]||o,n[f]=n[f]||t.disabled,n[g]=n[g]||e,l[o]=n,s.push(n),t.selected&&y.items.push(o)))}var t,e,i,n,s=y.options,l={};for(y.maxItems=u.hasAttribute("multiple")?null:1,t=0,e=(n=u.children).length;t<e;t++)"optgroup"===(i=n[t].tagName.toLowerCase())?function(t){var e,i=t.getAttribute("label");i&&((e=r(t))[v]=i,e[m]=i,e[f]=t.disabled,y.optgroups.push(e));for(var n,o=0,s=(n=t.children).length;o<s;o++)a(n[o],i)}(n[t]):"option"===i&&a(n[t])}:function(){var t,e,i,n,o=u.getAttribute(p);if(o)for(y.options=JSON.parse(o),t=0,e=y.options.length;t<e;t++)y.items.push(y.options[t][h]);else{var s=u.value.trim()||"";if(!c.allowEmptyOption&&!s.length)return;for(t=0,e=(i=s.split(c.delimiter)).length;t<e;t++)(n={})[d]=i[t],n[h]=i[t],y.options.push(n);y.items=i}})(),P(!0,{},D.defaults,y,t)}function l(t){return(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function i(e,i,t){var n,o=e.trigger,s={};for(n in e.trigger=function(){var t=arguments[0];if(-1===i.indexOf(t))return o.apply(e,arguments);s[t]=arguments},t.apply(e,[]),e.trigger=o,s)s.hasOwnProperty(n)&&o.apply(e,s[n])}function O(t){if(t.jquery)return t[0];if(t instanceof HTMLElement)return t;if(-1<t.indexOf("<")){var e=document.createElement("div");return e.innerHTML=t.trim(),e.firstChild}return document.querySelector(t)}function u(t,e){var i=document.createEvent("HTMLEvents");i.initEvent(e,!0,!1),t.dispatchEvent(i)}function c(e,i){Object.keys(i).forEach(function(t){e.style[t]=i[t]})}function x(t){var e=y.apply(null,arguments);t=w(t);for(var i,n=0;n<t.length;n++){(i=t[n].classList).add.apply(i,o(e))}}function F(t){var e=y.apply(null,arguments);t=w(t);for(var i,n=0;n<t.length;n++){(i=t[n].classList).remove.apply(i,o(e))}}function C(i,t,n,o){for(var e=t.split(/\s/),s=function(t){var e=A(t.target,n,i);e&&(t.delegateTarget=e,o.call(e,t))},r=0;r<e.length;r++)i.addEventListener(e[r],s,!0)}function p(t,e){if(!t)return-1;e=e||t.nodeName;for(var i=0;t=t.previousElementSibling;)t.matches(e)&&i++;return i}function f(t){var e,i;return!(!t||"[object Object]"!==toString.call(t))&&(!(e=_(t))||"function"==typeof(i=S.call(e,"constructor")&&e.constructor)&&I.call(i)===L)}var e=/Mac/.test(navigator.userAgent),d=e?91:17,g=e?18:17,v=e?"metaKey":"ctrlKey",m=e?"altKey":"ctrlKey",k=function(t){return null==t?null:"boolean"==typeof t?t?"1":"0":t+""},y=function(){for(var t=[],e=1;e<arguments.length;e++){var i=arguments[e];"string"==typeof i&&(i=i.trim().split(/[\11\12\14\15\40]/)),Array.isArray(i)&&(t=t.concat(i))}return t.filter(Boolean)},w=function(t){return Array.isArray(t)||(t=[t]),t},A=function(t,e,i){for(;t&&t.matches;){if(t.matches(e))return t;if(t==i)break;t=t.parentNode}},b=function(t,e){return 0<e?t[t.length-1]:t[0]},S={}.hasOwnProperty,I=S.toString,_=Object.getPrototypeOf,L=I.call(Object),P=function t(e){var i,n,o,s,r,a,l,u=e||{},c=1,p=arguments.length,d=!1;for("boolean"==typeof u&&(d=u,u=arguments[c]||{},c++),"object"===h(u)||"function"==typeof(l=u)&&"number"!=typeof l.nodeType||(u={}),c===p&&(u=this,c--);c<p;c++)if(null!=(i=arguments[c]))for(n in i)s=i[n],"__proto__"!==n&&u!==s&&(d&&s&&(f(s)||(r=Array.isArray(s)))?(o=u[n],a=r&&!Array.isArray(o)?[]:r||f(o)?o:{},r=!1,u[n]=t(d,a,s)):void 0!==s&&(u[n]=s));return u},D=function(t,e){var i,n,o=this;if((t=O(t)).tomselect)throw new Error("Tom Select already initialized on this element");t.tomselect=o,e=a(t,e);var s=(window.getComputedStyle&&window.getComputedStyle(t,null)).getPropertyValue("direction");for(Object.assign(o,{order:0,settings:e,input:t,tabIndex:t.getAttribute("tabindex")||"",is_select_tag:"select"===t.tagName.toLowerCase(),rtl:/rtl/i.test(s),highlightedValue:null,isBlurring:!1,isOpen:!1,isDisabled:!1,isRequired:t.required,isInvalid:!1,isLocked:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,ignoreFocus:!1,ignoreBlur:!1,ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},activeOption:null,activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{item:{},option:{}}}),o.settings.load&&o.settings.loadThrottle&&(o.settings.load=o.loadDebounce(o.settings.load,o.settings.loadThrottle)),o.sifter=new r(this.options,{diacritics:e.diacritics}),i=0,n=o.settings.options.length;i<n;i++)o.registerOption(o.settings.options[i]);for(delete o.settings.options,i=0,n=o.settings.optgroups.length;i<n;i++)o.registerOptionGroup(o.settings.optgroups[i]);delete o.settings.optgroups,o.settings.mode=o.settings.mode||(1===o.settings.maxItems?"single":"multi"),"boolean"!=typeof o.settings.hideSelected&&(o.settings.hideSelected="multi"===o.settings.mode),"string"==typeof o.settings.createFilter&&(o.settings.createFilter=new RegExp(o.settings.createFilter)),o.initializePlugins(o.settings.plugins),o.setupCallbacks(),o.setupTemplates(),o.setup()};if(void 0===t)throw'Dependency MicroPlugin is missing. Make sure you either: (1) are using the "complete" version of Tom Select, or (2) require MicroPlugin before you load Tom Select.';return s.mixin(D),t.mixin(D),Object.assign(D.prototype,{setup:function(){var i,t,e,n,o,s,r,a,l=this,u=l.settings,c=l.input,p=l.settings.mode,d=c.getAttribute("class")||"",h=O("<div>");if(x(h,u.wrapperClass,d,p),i=O('<div class="items">'),x(i,u.inputClass),h.append(i),e=O('<div style="display:none">'),x(e,u.dropdownClass,p),n=O('<div style="scroll-behavior: smooth;">'),x(n,u.dropdownContentClass),e.append(n),O(u.dropdownParent||h).appendChild(e),u.controlInput)t=O(u.controlInput);else{t=O('<input type="text" autocomplete="off" />');for(var f=["autocorrect","autocapitalize","autocomplete"],g=0;g<f.length;g++){var v=f[g];c.getAttribute(v)&&t.setAttribute(v,c.getAttribute(v))}}u.controlInput||(t.setAttribute("tabindex",c.disabled?"-1":l.tabIndex),i.appendChild(t)),(s=c.getAttribute("id"))&&(t.setAttribute("id",s+"-tomselected"),(r=document.querySelector("label[for='"+s+"']"))&&r.setAttribute("for",s+"-tomselected")),l.settings.copyClassesToDropdown&&x(e,d),h.style.width=c.style.width,l.plugins.names.length&&(o="plugin-"+l.plugins.names.join(" plugin-"),x([h,e],o)),(null===u.maxItems||1<u.maxItems)&&l.is_select_tag&&c.setAttribute("multiple","multiple"),l.settings.placeholder&&t.setAttribute("placeholder",u.placeholder),!l.settings.splitOn&&l.settings.delimiter&&(a=l.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),l.settings.splitOn=new RegExp("\\s*"+a+"+\\s*")),t.type=c.type,l.control=i,l.control_input=t,l.wrapper=h,l.dropdown=e,l.dropdown_content=n,C(e,"mouseenter","[data-selectable]",function(){return l.onOptionHover.apply(l,arguments)}),C(e,"mousedown","[data-selectable]",function(){return l.onOptionSelect.apply(l,arguments)}),i.addEventListener("mousedown",function(t){var e=A(t.target,"."+l.settings.itemClass,i);return e?(t.delegateTarget=e,l.onItemSelect.call(l,t)):l.onMouseDown.call(l,t)}),i.addEventListener("click",function(){return l.onClick.apply(l,arguments)}),t.addEventListener("mousedown",function(t){t.stopPropagation()}),t.addEventListener("keydown",function(){return l.onKeyDown.apply(l,arguments)}),t.addEventListener("keyup",function(){return l.onKeyUp.apply(l,arguments)}),t.addEventListener("keypress",function(){return l.onKeyPress.apply(l,arguments)}),t.addEventListener("resize",function(){l.positionDropdown.apply(l,[])}),t.addEventListener("blur",function(){return l.onBlur.apply(l,arguments)}),t.addEventListener("focus",function(){return l.ignoreBlur=!1,l.onFocus.apply(l,arguments)}),t.addEventListener("paste",function(){return l.onPaste.apply(l,arguments)});function m(t){if(l.isFocused){if(A(t.target,"."+l.settings.wrapperClass,l.wrapper))return!1;l.blur(t.target)}}function y(){l.isOpen&&l.positionDropdown.apply(l,arguments)}function w(){l.ignoreHover=!1}document.addEventListener("mousedown",m),window.addEventListener("sroll",y),window.addEventListener("resize",y),window.addEventListener("mousemove",w),l._destroy=function(){document.removeEventListener("mousedown",m),window.removeEventListener("mousemove",w),window.removeEventListener("sroll",y),window.removeEventListener("resize",y)};for(var b=[];0<c.children.length;)b.push(c.children[0]),c.children[0].remove();this.revertSettings={children:b,tabindex:c.getAttribute("tabindex")},c.setAttribute("tabindex",-1),c.setAttribute("hidden","hidden"),c.insertAdjacentElement("afterend",l.wrapper),l.setValue(u.items),delete u.items,l.supportsValidity()&&c.addEventListener("invalid",function(t){t.preventDefault(),l.isInvalid=!0,l.refreshState()}),l.updateOriginalInput(),l.refreshItems(),l.refreshState(),l.isSetup=!0,c.disabled&&l.disable(),l.on("change",this.onChange),x(c,"tomselected"),l.trigger("initialize"),!0===u.preload&&l.onSearchChange("")},supportsValidity:function(){return!/android/i.test(window.navigator.userAgent)&&!!document.createElement("input").validity},setupTemplates:function(){var i=this.settings.labelField,n=this.settings.optgroupLabelField,t={optgroup:function(){return'<div class="optgroup"></div>'},optgroup_header:function(t,e){return'<div class="optgroup-header">'+e(t[n])+"</div>"},option:function(t,e){return"<div>"+e(t[i])+"</div>"},item:function(t,e){return"<div>"+e(t[i])+"</div>"},option_create:function(t,e){return'<div class="create">Add <strong>'+e(t.input)+"</strong>&hellip;</div>"},no_results:function(){return'<div class="no-results">No results found</div>'}};this.settings.render=Object.assign({},t,this.settings.render)},setupCallbacks:function(){var t,e,i={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(t in i)(e=this.settings[i[t]])&&this.on(t,e)},onClick:function(t){this.isFocused&&this.isOpen||(this.focus(),t.preventDefault())},onMouseDown:function(t){var e=this;if(e.isFocused){if(t.target!==e.control_input)return"single"===e.settings.mode?e.isOpen?e.close():e.open():e.setActiveItem(null),!1}else window.setTimeout(function(){e.focus()},0)},onChange:function(){u(this.input,"change")},onPaste:function(t){var o=this;o.isFull()||o.isInputHidden||o.isLocked?t.preventDefault():o.settings.splitOn&&setTimeout(function(){var t=o.inputValue();if(t.match(o.settings.splitOn))for(var e=t.trim().split(o.settings.splitOn),i=0,n=e.length;i<n;i++)o.createItem(e[i])},0)},onKeyPress:function(t){if(this.isLocked)return t&&t.preventDefault();var e=String.fromCharCode(t.keyCode||t.which);return this.settings.create&&"multi"===this.settings.mode&&e===this.settings.delimiter?(this.createItem(),t.preventDefault(),!1):void 0},onKeyDown:function(t){t.target,this.control_input;var e,i,n=this;if(n.isLocked)9!==t.keyCode&&t.preventDefault();else{switch(t.keyCode){case 65:if(n.isKeyDown(d,t))return void n.selectAll();break;case 27:return void(n.isOpen&&(t.preventDefault(),t.stopPropagation(),n.close()));case 40:return!n.isOpen&&n.hasOptions?n.open():n.activeOption&&(n.ignoreHover=!0,(e=n.getAdjacent(n.activeOption,1))&&n.setActiveOption(e,!0)),void t.preventDefault();case 38:return n.activeOption&&(n.ignoreHover=!0,(i=n.getAdjacent(n.activeOption,-1))&&n.setActiveOption(i,!0)),void t.preventDefault();case 13:return void(n.isOpen&&n.activeOption&&(n.onOptionSelect({delegateTarget:n.activeOption}),t.preventDefault()));case 37:return void n.advanceSelection(-1,t);case 39:return void n.advanceSelection(1,t);case 9:return n.settings.selectOnTab&&n.isOpen&&n.activeOption&&(n.onOptionSelect({delegateTarget:n.activeOption}),t.preventDefault()),void(n.settings.create&&n.createItem()&&t.preventDefault());case 8:case 46:return void n.deleteSelection(t)}!n.isInputHidden||n.isKeyDown(d,t)||t.preventDefault()}},onKeyUp:function(t){var e=this;if(e.isLocked)return t&&t.preventDefault();var i=e.inputValue();e.lastValue!==i&&(e.lastValue=i,e.onSearchChange(i),e.refreshOptions(),e.trigger("type",i))},onSearchChange:function(e){var i=this,n=i.settings.load;n&&(i.loadedSearches.hasOwnProperty(e)||(i.loadedSearches[e]=!0,i.load(function(t){n.apply(i,[e,t])})))},onFocus:function(t){var e=this,i=e.isFocused;if(e.isDisabled)return e.blur(),t&&t.preventDefault(),!1;e.ignoreFocus||(e.isFocused=!0,"focus"===e.settings.preload&&e.onSearchChange(""),i||e.trigger("focus"),e.activeItems.length||(e.showInput(),e.setActiveItem(null),e.refreshOptions(!!e.settings.openOnFocus)),e.refreshState())},onBlur:function(t,e){var i=this;if(i.isFocused){if(i.isFocused=!1,i.ignoreFocus=!1,!i.ignoreBlur&&document.activeElement===i.dropdown_content)return i.ignoreBlur=!0,void i.onFocus(t);var n=function(){i.close(),i.setActiveItem(null),i.setActiveOption(null),i.setCaret(i.items.length),i.refreshState(),e&&e.focus&&e.focus(),i.isBlurring=!1,i.trigger("blur")};i.isBlurring=!0,i.settings.create&&i.settings.createOnBlur?i.createItem(null,!1,n):n()}},onOptionHover:function(t){this.ignoreHover||this.setActiveOption(t.delegateTarget,!1)},onOptionSelect:function(t){var e,i=this;t.preventDefault&&(t.preventDefault(),t.stopPropagation());var n=t.delegateTarget;n&&(n.parentNode&&n.parentNode.matches("[data-disabled]")||(n.classList.contains("create")?i.createItem(null,function(){i.settings.closeAfterSelect&&i.close()}):void 0!==(e=n.dataset.value)&&(i.lastQuery=null,i.addItem(e),i.settings.closeAfterSelect?i.close():!i.settings.hideSelected&&t.type&&/mouse/.test(t.type)&&i.setActiveOption(i.getOption(e)))))},onItemSelect:function(t){this.isLocked||"multi"===this.settings.mode&&(t.preventDefault(),this.setActiveItem(t.delegateTarget,t))},load:function(t){var i=this;x(i.wrapper,i.settings.loadingClass),i.loading++,t.apply(i,[function(t,e){i.loading=Math.max(i.loading-1,0),e&&e.length&&e.forEach(function(t){i.addOptionGroup(t[i.settings.optgroupValueField],t)}),t&&t.length&&i.addOption(t),i.refreshOptions(i.isFocused&&!i.isInputHidden),i.loading||F(i.wrapper,i.settings.loadingClass),i.trigger("load",t)}])},loadDebounce:function(i,n){var o;return function(){var t=this,e=arguments;o&&(t.loading=Math.max(t.loading-1,0)),window.clearTimeout(o),o=window.setTimeout(function(){o=null,i.apply(t,e)},n)}},setTextboxValue:function(t){var e=this.control_input;e.value!==t&&(e.value=t,u(e,"update"),this.lastValue=t)},getValue:function(){return this.is_select_tag&&this.input.hasAttribute("multiple")?this.items:this.items.join(this.settings.delimiter)},setValue:function(t,e){i(this,e?[]:["change"],function(){this.clear(e),this.addItems(t,e)})},setActiveItem:function(t,e){var i,n,o,s,r,a;if("single"!==this.settings.mode){if(!t)return F(this.activeItems,"active"),this.activeItems=[],void(this.isFocused&&this.showInput());if("mousedown"===(i=e&&e.type.toLowerCase())&&this.isKeyDown(16,e)&&this.activeItems.length){for(a=this.getLastActive(),o=Array.prototype.indexOf.apply(this.control.children,[a]),(s=Array.prototype.indexOf.apply(this.control.children,[t]))<o&&(r=o,o=s,s=r),n=o;n<=s;n++)t=this.control.children[n],-1===this.activeItems.indexOf(t)&&this.setActiveItemClass(t);e.preventDefault()}else"mousedown"===i&&this.isKeyDown(g,e)||"keydown"===i&&this.isKeyDown(16,e)?t.classList.contains("active")?this.removeActiveItem(t):this.setActiveItemClass(t):(F(this.activeItems,"active"),this.activeItems=[],this.setActiveItemClass(t));this.hideInput(),this.isFocused||this.focus()}},setActiveItemClass:function(t){var e=this.control.querySelector(".last-active");e&&F(e,"last-active"),x(t,"active last-active"),-1==this.activeItems.indexOf(t)&&this.activeItems.push(t)},removeActiveItem:function(t){var e=this.activeItems.indexOf(t);this.activeItems.splice(e,1),F(t,"active")},setActiveOption:function(t,e){var i,n,o;t!==this.activeOption&&(this.activeOption&&F(this.activeOption,"active"),this.activeOption=null,t&&(this.activeOption=t,x(t,"active"),!e&&void 0!==e||(i=this.dropdown_content.clientHeight,e=this.dropdown_content.scrollTop||0,n=this.activeOption.offsetHeight,i+e<(o=this.activeOption.getBoundingClientRect().top-this.dropdown_content.getBoundingClientRect().top+e)+n?this.dropdown_content.scrollTop=o-i+n:o<e&&(this.dropdown_content.scrollTop=o))))},selectAll:function(){"single"!==this.settings.mode&&(this.activeItems=this.controlChildren(),this.activeItems.length&&(x(this.activeItems,"active"),this.hideInput(),this.close()),this.focus())},hideInput:function(){this.settings.controlInput||(this.setTextboxValue(""),c(this.control_input,{opacity:0,position:"absolute",left:(this.rtl?1e4:-1e4)+"px"}),this.isInputHidden=!0)},showInput:function(){this.settings.controlInput||(c(this.control_input,{opacity:1,position:"relative",left:0}),this.isInputHidden=!1)},inputValue:function(){return this.control_input.value.trim()},focus:function(){var t=this;t.isDisabled||(t.ignoreFocus=!0,t.control_input.focus(),window.setTimeout(function(){t.ignoreFocus=!1,t.onFocus()},0))},blur:function(t){this.control_input.blur(),this.onBlur(null,t)},getScoreFunction:function(t){return this.sifter.getScoreFunction(t,this.getSearchOptions())},getSearchOptions:function(){var t=this.settings,e=t.sortField;return"string"==typeof e&&(e=[{field:e}]),{fields:t.searchField,conjunction:t.searchConjunction,sort:e,nesting:t.nesting}},search:function(t){var e,i,n,o=this,s=o.settings,r=this.getSearchOptions();if(s.score&&"function"!=typeof(n=o.settings.score.apply(this,[t])))throw new Error('Tom Select "score" setting must be a function that returns a function');if(t!==o.lastQuery?(o.lastQuery=t,i=o.sifter.search(t,Object.assign(r,{score:n})),o.currentResults=i):i=P({},o.currentResults),s.hideSelected)for(e=i.items.length-1;0<=e;e--)-1!==o.items.indexOf(k(i.items[e].id))&&i.items.splice(e,1);return i},refreshOptions:function(t){var e,i,n,o,s,r;void 0===t&&(t=!0);var a,l,u,c,p,d,h=this,f=h.inputValue(),g=h.search(f),v=h.activeOption&&k(h.activeOption.dataset.value),m=!1,y=g.items.length;for("number"==typeof h.settings.maxOptions&&(y=Math.min(y,h.settings.maxOptions)),0<y&&(m=!0),i={},n=[],e=0;e<y;e++)for(var w,b=h.options[g.items[e].id],O=k(b[h.settings.valueField]),C=(C=h.getOption(O))||h.render("option",b),A=b[h.settings.optgroupField]||"",S=0,I=(w=Array.isArray(A)?A:[A])&&w.length;S<I;S++)A=w[S],h.optgroups.hasOwnProperty(A)||(A=""),i.hasOwnProperty(A)||(i[A]=document.createDocumentFragment(),n.push(A)),0<S&&(C=C.cloneNode(!0),F(C,"active")),i[A].appendChild(C);for(this.settings.lockOptgroupOrder&&n.sort(function(t,e){return(h.optgroups[t].$order||0)-(h.optgroups[e].$order||0)}),o=document.createDocumentFragment(),e=0,y=n.length;e<y;e++){A=n[e],h.optgroups.hasOwnProperty(A)&&i[A].children.length?((a=h.render("optgroup",h.optgroups[A])).appendChild(h.render("optgroup_header",h.optgroups[A])),a.appendChild(i[A]),o.appendChild(a)):o.appendChild(i[A])}if(h.dropdown_content.innerHTML="",h.dropdown_content.appendChild(o),h.settings.highlight&&(h.dropdown_content,l=document.querySelectorAll("span.highlight"),Array.prototype.forEach.call(l,function(t,e){var i=t.parentNode;i.replaceChild(t.firstChild,t),i.normalize()}),g.query.length&&g.tokens.length))for(e=0,y=g.tokens.length;e<y;e++)!function(t,e){var u,i;"string"==typeof e&&!e.length||(u="string"==typeof e?new RegExp(e,"i"):e,i=function t(e){var i=0;if(3===e.nodeType){var n,o,s,r,a=e.data.search(u);0<=a&&0<e.data.length&&(n=e.data.match(u),(o=document.createElement("span")).className="highlight",(s=e.splitText(a)).splitText(n[0].length),r=s.cloneNode(!0),o.appendChild(r),s.parentNode.replaceChild(o,s),i=1)}else if(1===e.nodeType&&e.childNodes&&!/(script|style)/i.test(e.tagName)&&("highlight"!==e.className||"SPAN"!==e.tagName))for(var l=0;l<e.childNodes.length;++l)l+=t(e.childNodes[l]);return i},i(t))}(h.dropdown_content,g.tokens[e].regex);if(!h.settings.hideSelected)for(e=0,y=h.items.length;e<y;e++){var _=h.getOption(h.items[e]);_&&x(_,"selected")}0===g.items.length&&h.settings.render.no_results&&!h.loading&&f.length&&(u=h.render("no_results",{input:f}),m=!0,h.dropdown_content.insertBefore(u,h.dropdown_content.firstChild)),(s=h.canCreate(f))&&(m=!0,r=h.render("option_create",{input:f}),h.dropdown_content.insertBefore(r,h.dropdown_content.firstChild)),h.hasOptions=0<g.items.length||s,m?(d=0<g.items.length?(p=v&&h.getOption(v))&&h.dropdown_content.contains(p)?p:"single"===h.settings.mode&&h.items.length?h.getOption(h.items[0]):(c=0,r&&!h.settings.addPrecedence&&(c=1),h.selectable()[c]):r,h.setActiveOption(d),t&&!h.isOpen&&h.open()):(h.setActiveOption(null),t&&h.isOpen&&h.close())},selectable:function(){return this.dropdown_content.querySelectorAll("[data-selectable]")},addOption:function(t){var e,i,n,o=this;if(Array.isArray(t))for(e=0,i=t.length;e<i;e++)o.addOption(t[e]);else(n=o.registerOption(t))&&(o.userOptions[n]=!0,o.lastQuery=null,o.trigger("option_add",n,t))},registerOption:function(t){var e=k(t[this.settings.valueField]);return null!=e&&!this.options.hasOwnProperty(e)&&(t.$order=t.$order||++this.order,this.options[e]=t,e)},registerOptionGroup:function(t){var e=k(t[this.settings.optgroupValueField]);return!!e&&(t.$order=t.$order||++this.order,this.optgroups[e]=t,e)},addOptionGroup:function(t,e){e[this.settings.optgroupValueField]=t,(t=this.registerOptionGroup(e))&&this.trigger("optgroup_add",t,e)},removeOptionGroup:function(t){this.optgroups.hasOwnProperty(t)&&(delete this.optgroups[t],this.clearCache(),this.trigger("optgroup_remove",t))},clearOptionGroups:function(){this.optgroups={},this.clearCache(),this.trigger("optgroup_clear")},updateOption:function(t,e){var i,n,o,s,r,a,l,u=this;if(t=k(t),o=k(e[u.settings.valueField]),null!==t&&u.options.hasOwnProperty(t)){if("string"!=typeof o)throw new Error("Value must be set in option data");l=u.options[t].$order,o!==t&&(delete u.options[t],-1!==(s=u.items.indexOf(t))&&u.items.splice(s,1,o)),e.$order=e.$order||l,u.options[o]=e,r=u.renderCache.item,a=u.renderCache.option,r&&(delete r[t],delete r[o]),a&&(delete a[t],delete a[o]),-1!==u.items.indexOf(o)&&(i=u.getItem(t),n=u.render("item",e),i.classList.contains("active")&&x(n,"active"),i.parentNode.insertBefore(n,i),i.remove()),u.lastQuery=null,u.isOpen&&u.refreshOptions(!1)}},removeOption:function(t,e){var i=this;t=k(t);var n=i.renderCache.item,o=i.renderCache.option;n&&delete n[t],o&&delete o[t],delete i.userOptions[t],delete i.options[t],i.lastQuery=null,i.trigger("option_remove",t),i.removeItem(t,e)},clearOptions:function(){this.loadedSearches={},this.userOptions={},this.clearCache();var t={};for(key in this.options)this.options.hasOwnProperty(key)&&0<=this.items.indexOf(key)&&(t[key]=this.options[key]);this.options=this.sifter.items=t,this.lastQuery=null,this.trigger("option_clear")},getOption:function(t){return this.renderCache.option.hasOwnProperty(t)?this.renderCache.option[t]:this.getElementWithValue(t,this.selectable())},getAdjacent:function(t,e,i){var n=2<arguments.length&&void 0!==i?i:"option";if(t){var o=this.settings.optionClass,s=this.dropdown;"item"==n&&(s=this.control,o=this.settings.itemClass);for(var r=s.querySelectorAll("."+o),a=0;a<r.length;a++)if(r[a]==t)return 0<e?r[a+1]:r[a-1]}},getElementWithValue:function(t,e){if(null!=(t=k(t)))for(var i=0,n=e.length;i<n;i++)if(e[i].getAttribute("data-value")===t)return e[i]},getItem:function(t){return this.getElementWithValue(t,this.control.children)},addItems:function(t,e){this.buffer=document.createDocumentFragment();for(var i=this.control.children,n=0;n<i.length;n++)this.buffer.appendChild(i[n]);for(var o=Array.isArray(t)?t:[t],n=0,s=o.length;n<s;n++)this.isPending=n<s-1,this.addItem(o[n],e);var r=this.control;r.insertBefore(this.buffer,r.firstChild),this.buffer=null},addItem:function(a,l){i(this,l?[]:["change"],function(){var t,e,i,n,o,s=this,r=s.settings.mode;a=k(a),(-1===s.items.indexOf(a)||("single"===r&&s.close(),"single"!==r&&s.settings.duplicates))&&s.options.hasOwnProperty(a)&&("single"===r&&s.clear(l),"multi"===r&&s.isFull()||(o=s.render("item",s.options[a]),this.control.contains(o)&&(o=o.cloneNode(!0)),t=s.isFull(),s.items.splice(s.caretPos,0,a),s.insertAtCaret(o),s.isPending&&(t||!s.isFull())||s.refreshState(),s.isSetup&&(e=s.selectable(),s.isPending||(i=s.getOption(a),n=s.getAdjacent(i,1),s.refreshOptions(s.isFocused&&"single"!==r),n&&s.setActiveOption(n)),!e.length||s.isFull()?s.close():s.isPending||s.positionDropdown(),s.trigger("item_add",a,o),s.isPending||s.updateOriginalInput({silent:l}))))})},removeItem:function(t,e){var i,n,o=this.getItem(t);o&&(t=k(o.dataset.value),-1!==(i=this.items.indexOf(t))&&(o.remove(),o.classList.contains("active")&&(n=this.activeItems.indexOf(o),this.activeItems.splice(n,1),F(o,"active")),this.items.splice(i,1),this.lastQuery=null,!this.settings.persist&&this.userOptions.hasOwnProperty(t)&&this.removeOption(t,e),i<this.caretPos&&this.setCaret(this.caretPos-1),this.refreshState(),this.updateOriginalInput({silent:e}),this.positionDropdown(),this.trigger("item_remove",t,o)))},createItem:function(t,i){var n=this,o=n.caretPos;t=t||n.inputValue();var s=arguments[arguments.length-1];if("function"!=typeof s&&(s=function(){}),"boolean"!=typeof i&&(i=!0),!n.canCreate(t))return s(),!1;n.lock();var e,r,a="function"==typeof n.settings.create?this.settings.create:function(t){var e={};return e[n.settings.labelField]=t,e[n.settings.valueField]=t,e},l=(r=!(e=function(t){if(n.unlock(),!t||"object"!==h(t))return s();var e=k(t[n.settings.valueField]);if("string"!=typeof e)return s();n.setTextboxValue(""),n.addOption(t),n.setCaret(o),n.addItem(e),n.refreshOptions(i&&"single"!==n.settings.mode),s(t)}),function(){r||(r=!0,e.apply(this,arguments))}),u=a.apply(this,[t,l]);return void 0!==u&&l(u),!0},refreshItems:function(){this.lastQuery=null,this.isSetup&&this.addItem(this.items),this.refreshState(),this.updateOriginalInput()},refreshState:function(){var t=this;t.refreshValidityState();var e=t.isFull(),i=t.isLocked;t.wrapper.classList.toggle("rtl",t.rtl);var n,o=t.control.classList;o.toggle("focus",t.isFocused),o.toggle("disabled",t.isDisabled),o.toggle("required",t.isRequired),o.toggle("invalid",t.isInvalid),o.toggle("locked",i),o.toggle("full",e),o.toggle("not-full",!e),o.toggle("input-active",t.isFocused&&!t.isInputHidden),o.toggle("dropdown-active",t.isOpen),o.toggle("has-options",(n=t.options,0===Object.keys(n).length)),o.toggle("has-items",0<t.items.length)},refreshValidityState:function(){if(!this.isRequired)return!1;var t=!this.items.length;this.isInvalid=t,this.control_input.required=t,this.input.required=!t},isFull:function(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(t){var e,i,n,o,s=this;if(t=t||{},s.is_select_tag){for(n=[],e=0,i=s.items.length;e<i;e++)o=s.options[s.items[e]][s.settings.labelField]||"",n.push('<option value="'+l(s.items[e])+'" selected="selected">'+l(o)+"</option>");n.length||this.input.hasAttribute("multiple")||n.push('<option value="" selected="selected"></option>'),s.input.innerHTML=n.join("")}else s.input.value=s.getValue(),s.input.setAttribute("value",s.input.value);s.isSetup&&(t.silent||s.trigger("change",s.input.value))},open:function(){var t=this;t.isLocked||t.isOpen||"multi"===t.settings.mode&&t.isFull()||(t.focus(),t.isOpen=!0,t.refreshState(),c(t.dropdown,{visibility:"hidden",display:"block"}),t.positionDropdown(),c(t.dropdown,{visibility:"visible",display:"block"}),t.trigger("dropdown_open",t.dropdown))},close:function(){var t=this,e=t.isOpen;"single"===t.settings.mode&&t.items.length&&(t.hideInput(),t.isBlurring||t.blur()),t.isOpen=!1,c(t.dropdown,{display:"none"}),t.setActiveOption(null),t.refreshState(),e&&t.trigger("dropdown_close",t.dropdown)},positionDropdown:function(){var t,e=0,i=this.control,n=i.offsetHeight;"body"===this.settings.dropdownParent?(n+=(t=i.getBoundingClientRect()).top+window.scrollY,e=t.left+window.scrollX):this.settings.dropdownParent?n=(i=O(this.settings.dropdownParent)).offsetHeight:(n+=i.offsetTop,e=i.offsetLeft),c(this.dropdown,{width:i.getBoundingClientRect().width+"px",top:n+"px",left:e+"px"})},clear:function(t){if(this.items.length){for(var e=this.controlChildren(),i=0;i<e.length;i++)e[i].remove();this.items=[],this.lastQuery=null,this.setCaret(0),this.setActiveItem(null),this.updateOriginalInput({silent:t}),this.refreshState(),this.showInput(),this.trigger("clear")}},insertAtCaret:function(t){var e=Math.min(this.caretPos,this.items.length),i=this.buffer||this.control;0===e?i.insertBefore(t,i.firstChild):i.insertBefore(t,i.children[e]),this.setCaret(e+1)},deleteSelection:function(t){var e,i,n,o,s,r=this,a=t&&8===t.keyCode?-1:1,l={start:(s=r.control_input).selectionStart,length:s.selectionEnd-s.selectionStart},u=[];if(r.activeItems.length){for(o=b(r.activeItems,a),n=p(o),0<a&&n++,e=0,i=r.activeItems.length;e<i;e++)u.push(r.activeItems[e].dataset.value);t&&(t.preventDefault(),t.stopPropagation())}else(r.isFocused||"single"===r.settings.mode)&&r.items.length&&(a<0&&0===l.start&&0===l.length?u.push(r.items[r.caretPos-1]):0<a&&l.start===r.inputValue().length&&u.push(r.items[r.caretPos]));if(!u.length||"function"==typeof r.settings.onDelete&&!1===r.settings.onDelete.apply(r,[u,t]))return!1;for(void 0!==n&&r.setCaret(n);u.length;)r.removeItem(u.pop());return r.showInput(),r.positionDropdown(),r.refreshOptions(!1),!0},advanceSelection:function(t,e){var i,n,o;0!==t&&(this.rtl&&(t*=-1),this.isKeyDown(g,e)||this.isKeyDown(16,e)?(n=this.getLastActive(t),(o=this.getAdjacent(n,t,"item"))&&(o.classList.contains("active")&&this.removeActiveItem(n),this.setActiveItemClass(o))):this.isFocused&&!this.isInputHidden?this.inputValue().length||this.setCaret(this.caretPos+t):(n=this.getLastActive(t))&&(i=p(n),this.setCaret(0<t?i+1:i),this.setActiveItem(null)))},getLastActive:function(t){var e=this.control.querySelector(".last-active");return e||function(t,e,i){var n=t.querySelectorAll(e);if(n)return b(n,i)}(this.control,".active",t)},setCaret:function(t){var e=this;if(t="single"===e.settings.mode||e.settings.controlInput?e.items.length:Math.max(0,Math.min(e.items.length,t)),!e.settings.controlInput&&!e.isPending)for(var i,n=this.controlChildren(),o=n.length,s=0;s<o;s++)i=n[s],s<t?e.control_input.insertAdjacentElement("beforebegin",i):e.control.appendChild(i);e.caretPos=t},controlChildren:function(){return Array.prototype.filter.call(this.control.children,function(t){return"INPUT"!==t.nodeName})},lock:function(){this.close(),this.isLocked=!0,this.refreshState()},unlock:function(){this.isLocked=!1,this.refreshState()},disable:function(){this.input.disabled=!0,this.control_input.disabled=!0,this.control_input.tabIndex=-1,this.isDisabled=!0,this.lock()},enable:function(){this.input.disabled=!1,this.control_input.disabled=!1,this.control_input.tabIndex=this.tabIndex,this.isDisabled=!1,this.unlock()},destroy:function(){var t=this.revertSettings;this.trigger("destroy"),this.off(),this.wrapper.remove(),this.dropdown.remove(),this.input.innerHTML="",t.tabindex?this.input.setAttribute("tabindex",t.tabindex):this.input.removeAttribute("tabindex"),F(this.input,"tomselected"),this.input.removeAttribute("hidden");for(var e=0;e<t.children.length;e++)this.input.appendChild(t.children[e]);this._destroy(),delete this.input.tomselect},render:function(t,e){var i,n,o="",s=this;return"option"!==t&&"item"!==t||(i=k(e[s.settings.valueField]),!s.renderCache[t].hasOwnProperty(i))?(o=O(s.settings.render[t].apply(this,[e,l])),"option"===t||"option_create"===t?e[s.settings.disabledField]||o.setAttribute("data-selectable",""):"optgroup"===t&&(n=e[s.settings.optgroupValueField],o.setAttribute("data-group",n),e[s.settings.disabledField]&&o.setAttribute("data-disabled","")),"option"!==t&&"item"!==t||(o.setAttribute("data-value",i),x(o,"item"===t?s.settings.itemClass:s.settings.optionClass),s.renderCache[t][i]=o),o):s.renderCache[t][i]},clearCache:function(t){void 0===t?this.renderCache={item:{},option:{}}:this.renderCache[t]={}},canCreate:function(t){if(!this.settings.create)return!1;var e=this.settings.createFilter;return t.length&&("function"!=typeof e||e.apply(this,[t]))&&(!(e instanceof RegExp)||e.test(t))},isKeyDown:function(t,e){if(e){if(t==g&&e[m])return!0;if(t==d&&e[v])return!0;if(16==t&&e.shiftKey)return!0}return!1},hook:function(i,t,n){var o=this,s=o[t];o[t]=function(){var t,e;return"after"===i&&(t=s.apply(o,arguments)),e=n.apply(o,arguments),"instead"===i?e:("before"===i&&(t=s.apply(o,arguments)),t)}}}),D.count=0,D.defaults={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:!1,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:1e3,maxItems:null,hideSelected:null,duplicates:!1,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,closeAfterSelect:!1,scrollDuration:60,loadThrottle:300,loadingClass:"loading",dataAttr:null,optgroupField:"optgroup",valueField:"value",labelField:"text",disabledField:"disabled",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"tomselect-control",inputClass:"tomselect-input",dropdownClass:"tomselect-dropdown",dropdownContentClass:"tomselect-dropdown-content",itemClass:"item",optionClass:"option",dropdownParent:null,controlInput:null,copyClassesToDropdown:!0,render:{}},D.define("drag_drop",function(t){if(!$.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');var e,i,n;"multi"===this.settings.mode&&(i=(e=this).lock,n=e.unlock,e.hook("instead","lock",function(){var t=e.control.dataset.sortable;return t&&t.disable(),i.apply(e,arguments)}),e.hook("instead","unlock",function(){var t=e.control.dataset.sortable;return t&&t.enable(),n.apply(e,arguments)}),e.hook("after","setup",function(){var i=$(e.control).sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:e.isLocked,start:function(t,e){e.placeholder.css("width",e.helper.css("width")),i.css({overflow:"visible"})},stop:function(){i.css({overflow:"hidden"});var t=[];i.children("[data-value]").each(function(){t.push($(this).attr("data-value"))}),e.setValue(t)}})}))}),D.define("dropdown_header",function(e){var i=this;e=Object.assign({title:"Untitled",headerClass:"dropdown-header",titleRowClass:"dropdown-header-title",labelClass:"dropdown-header-label",closeClass:"dropdown-header-close",html:function(t){return'<div class="'+t.headerClass+'"><div class="'+t.titleRowClass+'"><span class="'+t.labelClass+'">'+t.title+'</span><a href="javascript:void(0)" class="'+t.closeClass+'">&times;</a></div></div>'}},e),i.hook("after","setup",function(){var t=O(e.html(e));i.dropdown.insertBefore(t,i.dropdown.firstChild)})}),D.define("input_autogrow",function(t){var a=this;a.hook("after","setup",function(){var t=document.createElement("span"),e=this.control_input;t.style.position="absolute",t.style.top="-99999px",t.style.left="-99999px",t.style.width="auto",t.style.padding=0,t.style.whiteSpace="pre",a.wrapper.appendChild(t);for(var i=["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"],n=0,o=i.length;n<o;n++){var s=i[n];t.style[s]=e.style[s]}function r(){t.textContent=e.value,e.style.width=t.clientWidth+"px"}e.addEventListener("input",r),e.addEventListener("keyup",r),e.addEventListener("blur",r),e.addEventListener("update",r)})}),D.define("no_backspace_delete",function(t){this.hook("instead","setActiveItem",function(){}),this.hook("instead","selectAll",function(){}),this.settings.onDelete=function(t,e){if(0<t.length&&e&&(8==e.keyCode||46==e.keyCode))return!1}}),D.define("optgroup_columns",function(a){var l=this;a=Object.assign({equalizeWidth:!0,equalizeHeight:!0},a);var s=l.onKeyDown;l.hook("instead","onKeyDown",function(t){var e,i,n,o;return!l.isOpen||37!==t.keyCode&&39!==t.keyCode?s.apply(l,arguments):(l.ignoreHover=!0,o=A(l.activeOption,"[data-group]"),e=p(l.activeOption,"[data-selectable]"),void((o=37===t.keyCode?o.previousSibling:o.nextSibling)&&(i=(n=o.querySelectorAll("[data-selectable]"))[Math.min(n.length-1,e)])&&l.setActiveOption(i)))});function t(){var t,e,i,n,o,s=l.dropdown_content.querySelectorAll("[data-group]"),r=s.length;if(r&&l.dropdown_content.clientWidth){if(a.equalizeHeight){for(t=e=0;t<r;t++)e=Math.max(e,s[t].clientHeight);for(t=0;t<r;t++)s[t].style.height=e+"px"}if(r&&l.dropdown_content.clientWidth&&a.equalizeWidth){for(o=l.dropdown_content.clientWidth-function t(){var e,i=t.width,n=document;return void 0===i&&((e=n.createElement("div")).innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>',e=e.firstChild,n.body.appendChild(e),i=t.width=e.offsetWidth-e.clientWidth,n.body.removeChild(e)),i}(),i=Math.round(o/r),t=0;t<r;t++)s[t].style.width=i+"px";1<r&&(n=o-i*(r-1),s[r-1].style.width=n+"px")}}}(a.equalizeHeight||a.equalizeWidth)&&(l.hook("after","positionDropdown",t),l.hook("after","refreshOptions",t))}),D.define("remove_button",function(t){t=Object.assign({label:"&times;",title:"Remove",className:"remove",append:!0},t);var o,s,r=this;t.append&&(o='<a href="javascript:void(0)" class="'+t.className+'" tabindex="-1" title="'+l(t.title)+'">'+t.label+"</a>",s=r.render,r.hook("instead","render",function(t,e){var i,n=s.apply(r,arguments);return"item"==t&&(i=O(o),n.appendChild(i),i.addEventListener("click",function(t){var e;t.preventDefault(),"single"!==r.settings.mode&&t.stopPropagation(),r.isLocked||(e=n.dataset.value,r.removeItem(e))})),n}))}),D.define("restore_on_backspace",function(n){var o=this;n.text=n.text||function(t){return t[o.settings.labelField]};var s=o.onKeyDown;o.hook("instead","onKeyDown",function(t){var e,i;return 8===t.keyCode&&""===o.control_input.value&&!o.activeItems.length&&0<=(e=o.caretPos-1)&&e<o.items.length?(i=o.options[o.items[e]],o.deleteSelection(t)&&(o.setTextboxValue(n.text.apply(o,[i])),o.refreshOptions(!0)),void t.preventDefault()):s.apply(o,arguments)})}),D});var tomSelect=function(t,e){return new TomSelect(t,e)};